<!--
 * @Date: 2024-05-28
 * @LastEditors: 不与
 * @LastEditTime: 2024-05-29
 * @FilePath: \STM32_Study\基础篇\MDK5编译例程和串口下载程序.md
-->
### MDK5编译例程

**编译**
- 部分编译：若工程未编译过则等效全局编译，否则只编译改变部分
- 全局编译：全部都编译


| 数据类型 | 占用Flash or SRAM | 说明                              |
| -------- | ----------------- | --------------------------------- |
| Code     | Flash             | 代码                              |
| RO-Data  | Flash             | 只读数据，一般是指const修饰的数据 |
| RW-Data  | Flash and SRAM    | 初值为非0的可读可写数据           |
| ZI-Data  | SRAM              | 初值为0的可读可写数据             |

> Build Output窗口可以查看程序flash和SRAM占用空间

<br>
<br>

### 串口下载程序

须知：
- ATK-XISP.exe软件只支持下载到内部FLASH
- STM32的ISP下载，常用串口1下载程序

硬件连接：
- USB UART接口连接
- PA9，PA10连接到RXD,TXD
- B0，B1用短路帽连接GND
- 电源打开NO
- 上电后PWR电源灯常亮（蓝色）

配置下载工具ATK-XISP

使用：
- 选择CH340虚拟串口，然后设置波特率
- 选择hex文件
- 勾选”编程后运行“ ”效验“ ”编程前执行全片擦除“
- 选择”DTR低电平复位，RTS高电平进BootLoader“
- 开始编程
> 战舰有一键下载电路，不需要按复位

STM32启动模式：
| BOOT1 | BOOT0 | 启动模式   |
| ----- | ----- | ---------- |
| X     | 0     | 主闪存储器 |
| 0     | 1     | 系统存储器 |
| 1     | 1     | 内置SRAM   |

> 系统存储器->BootLoader引导程序->ISP串口下载一般选择串口1

**实际：**
- ISP下载程序一般步骤：
1. BOOT0接高电平，BOOT1接低电平
2. 按复位键
- 程序执行步骤：
1. BOOT0接低电平，BOOT1接高电平
2. 按复位键

> 战舰有一键下载电路，不需要按复位
